(()=>{"use strict";function e(){function e(e){return e.split(" ")}function t(e,t){t.forEach((t=>{e.classList.add(t)}))}return{getID:function(){return"_"+Math.random().toString(36).substr(2,9)},classAdder:t,splitString:e,stringToClass:function(n,s){t(n,e(s))},getFormData:e=>{const t=new FormData(e.target);return Object.fromEntries(t)},toogleElement:function(e){let t=document.getElementById(e);t.classList.contains("d-none")?t.classList.remove("d-none"):t.classList.add("d-none")}}}const t={events:{},subscribe:function(e,t){console.log(`PUBSUB: someone just subscribed to know about ${e}`),this.events[e]=this.events[e]||[],this.events[e].push(t)},unsubscribe:function(e,t){console.log(`PUBSUB: someone just UNsubscribed from ${e}`),this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t)))},publish:function(e,t){console.log(`PUBSUB: Making an broadcast about ${e} with ${t}`),this.events[e]&&this.events[e].forEach((e=>{e(t)}))}};function n(){const n=function(){let e=[];return{addTask:t=>{e.push(t),console.log(e)},removeTask:t=>{let n;for(let s=0;s<e.length;s++)e[s].getId()==t&&(n=s),null==n&&-1==n||e.splice(n,1)},changeStatusbyID:t=>{let n;for(let s=0;s<e.length;s++)e[s].getId()==t&&(n=s),null==n&&-1==n||e[n].changeStatus()}}}(),s=e(),o=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),a=document.createElement("div");return s.stringToClass(o,"col-8 container-sm bg-light card-body"),s.stringToClass(r,"container-md card m-2 p-1 mr-1"),s.stringToClass(c,"container row"),s.stringToClass(a,"col-1 bg-light"),c.style="gap: 10px",r.append(c),o.append(r),t.subscribe("handleDone",(function(e){let t=e.id;n.changeStatusbyID(t)})),t.subscribe("handleDone",(function(e){const t=e.childNodes[3];t.classList.contains("btn-success")?t.classList.remove("btn-success"):t.classList.add("btn-success")})),t.subscribe("handleRemove",(function(e){e.remove()})),t.subscribe("handleRemove",(function(e){n.removeTask(e.id)})),t.subscribe("newTask",(e=>{var n;n=function(e){const n=document.createElement("div"),o=document.createElement("p"),r=document.createElement("p"),c=document.createElement("button"),a=document.createElement("button"),i=document.createElement("hr");return s.stringToClass(o,"m-2 col-xl"),s.stringToClass(r,"m-2 col-l"),s.stringToClass(c,"btn btn-outline-primary col-sm pl-2"),s.stringToClass(a,"btn btn-outline-danger col-sm"),n.append(o,a,c),c.innerText="DONE",a.innerText="Remove",console.log(e),r.innerText=`Belongs to Project group: ${e.project}`,o.innerText=e.taskName,o.style="flex-grow: 10",n.setAttribute("id",e.id),n.append(o,r,a,c,i),c.addEventListener("click",(e=>{t.publish("handleDone",e.target.parentNode)})),a.addEventListener("click",(e=>{t.publish("handleRemove",e.target.parentNode)})),n}(e),c.append(n)})),t.subscribe("newTask",(e=>{!function(e){let t=function(e){let t=e.taskName,n=e.project,s=((new Date).getDate(),e.id),o=!1;return{getName:()=>t,getTaskProject:()=>n,getId:()=>s,changeStatus:()=>{o=!o,console.log(o)}}}(e);n.addTask(t)}(e)})),t.subscribe("removeTask",(e=>n.removeTask)),o}document.addEventListener("DOMContentLoaded",(s=>{let o=document.getElementById("content");const r=function(){const t=e(),n=document.createElement("nav"),s=document.createElement("div"),o=document.createElement("a");return t.stringToClass(n,"navbar navbar-expand-md navbar-dark bg-dark"),t.stringToClass(s,"container-fluid"),t.stringToClass(o,"navbar-brand"),o.innerText="Todolist",s.append(o),n.append(s),n}(),c=function(){const n=e(),s=document.createElement("div"),o=document.createElement("a"),r=document.createElement("img"),c=document.createElement("span"),a=document.createElement("hr"),i=document.createElement("ul"),l=document.createElement("form"),d=document.createElement("div"),u=document.createElement("form"),m=document.createElement("div"),p=document.createElement("button"),b=document.createElement("input"),g=(document.createElement("area"),document.createElement("input")),h=document.createElement("button"),T=document.createElement("div"),f=document.createElement("button"),v=document.createElement("button"),E="form-control",k="btn btn-outline-primary";n.stringToClass(s,"d-flex flex-column flex-shrink-0 p-3 bg-light col-3 border"),n.stringToClass(r,"m-2"),n.stringToClass(o,"d-flex align-items-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none"),n.stringToClass(c,"fs-4"),n.stringToClass(i,"nav nav-pills flex-column mb-auto"),n.stringToClass(T,"b-example-divider d-flex justify-content-center"),n.stringToClass(f,"btn btn-primay"),n.stringToClass(v,"btn btn-primay m-2"),n.stringToClass(l,"form-group m-2 p-1 input-group d-none"),n.stringToClass(u,"form-group m-2 p-1 input-group d-none"),n.stringToClass(m,"d-flex justify-content-center"),n.stringToClass(g,E),n.stringToClass(h,k),n.stringToClass(p,k),n.stringToClass(b,E),s.style="width: 280px;",c.innerText="Projects",r.style="width: 30px",f.innerText="+ New Project",v.innerText="+ Task",d.style="width: 150px;",m.style="width: 200px",h.innerText="+",p.innerText="+",g.setAttribute("placeholder","New Project"),b.setAttribute("placeholder","New Task"),i.setAttribute("id","projectUl"),r.setAttribute("src","../sandbox/public/todo.svg"),l.setAttribute("action","submit"),l.setAttribute("id","formProject"),u.setAttribute("action","submit"),u.setAttribute("id","formTask"),u.setAttribute("name","taskForm"),b.setAttribute("name","taskName"),g.setAttribute("name","name");const C=function(){const e=[];return{addProject:t=>{e.push(t),console.log(e)},getLength:()=>e.length}}();return l.addEventListener("submit",(e=>{e.preventDefault();let s=n.getFormData(e);t.publish("liSubmit",s.name),t.publish("newProject",s),l.reset()})),t.subscribe("newProject",(function(e){let t={name:e.name,dateCreated:(new Date).getDate()};C.addProject(t)})),u.addEventListener("submit",(e=>{e.preventDefault();let s=n.getFormData(e);document.get;const o=document.querySelectorAll('[selected="true"]');0==o.length?alert("Need to Select Project"):(console.log("weeee wewwe"),console.log(o),s.project=o[0].innerText,s.id=n.getID(),console.log(s),C.getLength()>=1?(t.publish("newTask",s),u.reset()):alert("NEED ATLEAST ONE PROJECT"))})),f.addEventListener("click",(e=>{t.publish("toogleForm","formProject")})),v.addEventListener("click",(e=>{t.publish("toogleTask","formTask")})),t.subscribe("toogleForm",n.toogleElement),t.subscribe("toogleTask",n.toogleElement),t.subscribe("liSubmit",(function(e){const s=document.createElement("li"),o=document.createElement("a");return n.stringToClass(s,"nav-item m-2"),n.stringToClass(o,"nav-link active"),o.innerText=e,s.append(o),t.publish("createLi",s),s.addEventListener("click",(e=>{t.publish("projectClicked",e.target)})),s})),t.subscribe("projectClicked",(function(e){let t=document.getElementById("projectUl").childNodes;for(let e=0;e<t.length;e++)t[e].classList.remove("bg-success"),t[e].childNodes.forEach((e=>{e.classList.remove("bg-success")}));e.classList.add("bg-success")})),t.subscribe("projectClicked",(function(e){let t=document.getElementById("projectUl").childNodes;for(let n=0;n<t.length;n++)t[n].removeAttribute("selected"),t[n].childNodes.forEach((e=>{e.removeAttribute("selected")})),e.setAttribute("selected","true")})),t.subscribe("createLi",(function(e){document.querySelector("ul").append(e)})),o.append(r,c),d.append(g),l.append(h),l.append(d),u.append(p,b),m.append(u),s.append(o),s.append(f),s.append(v),s.append(l),s.append(m),s.append(a),s.append(i),s.append(T),{divSidebar:s}}().divSidebar,a=n();o.append(r);const i=document.createElement("div");i.classList.add("row"),i.append(c),i.append(a),o.append(i)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBU21DLGNBQWMsT0FDbkNxQyxFQUFJMUYsVUFBVUMsSUFBSSxPQUNsQnlGLEVBQUloQyxPQUFPa0MsR0FDWEYsRUFBSWhDLE9BQU9wQixHQUNYaUQsRUFBUTdCLE9BQU9nQyxFQUFHLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLy4vc3JjL2pzL2xpYnMuanMiLCJ3ZWJwYWNrOi8vdG9kby8uL3NyYy9qcy9wdWJzdWIuanMiLCJ3ZWJwYWNrOi8vdG9kby8uL3NyYy9qcy90YXNrcy5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL2pzL2RvbS5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL2pzL25hdmJhci5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL2pzL3NpZGViYXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXIgfSBmcm9tIFwiZGF0ZS1mbnMvbG9jYWxlXCI7XG5cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBsaWJzKCkge1xuXG4gICAgY29uc3QgZ2V0Rm9ybURhdGEgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZXZlbnQudGFyZ2V0KVxuICAgICAgICBjb25zdCBmb3JtUHJvcHMgPSBPYmplY3QuZnJvbUVudHJpZXMoZm9ybURhdGEpXG4gICAgICAgIHJldHVybiBmb3JtUHJvcHNcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzcGxpdFN0cmluZyhzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5zcGxpdChcIiBcIilcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGFzc0FkZGVyKGVsZW1lbnQsIGFycmF5KSB7XG4gICAgICAgIGFycmF5LmZvckVhY2goc3RyaW5nID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChzdHJpbmcpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0cmluZ1RvQ2xhc3MoZWxlbWVudCwgc3RyaW5nKSB7XG4gICAgICAgIGxldCBhcnIgPSBzcGxpdFN0cmluZyhzdHJpbmcpXG4gICAgICAgIGNsYXNzQWRkZXIoZWxlbWVudCwgYXJyKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldElEKCkge1xuICAgICAgICByZXR1cm4gJ18nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuICAgIH1cblxuXG5cbiAgICBmdW5jdGlvbiB0b29nbGVFbGVtZW50KGlkKSB7XG4gICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZC1ub25lJykpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJylcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZC1ub25lJylcbiAgICAgICAgfVxuXG4gICAgfVxuXG5cblxuXG4gICAgcmV0dXJuIHsgZ2V0SUQsIGNsYXNzQWRkZXIsIHNwbGl0U3RyaW5nLCBzdHJpbmdUb0NsYXNzLCBnZXRGb3JtRGF0YSwgdG9vZ2xlRWxlbWVudCB9XG5cbn1cblxuXG5cblxuXG5cblxuIiwiZXhwb3J0IGNvbnN0IHB1YnN1YiA9IHtcbiAgICBldmVudHM6IHt9LFxuICAgIHN1YnNjcmliZTogZnVuY3Rpb24gKGV2TmFtZSwgZm4pIHtcbiAgICAgICAgY29uc29sZS5sb2coYFBVQlNVQjogc29tZW9uZSBqdXN0IHN1YnNjcmliZWQgdG8ga25vdyBhYm91dCAke2V2TmFtZX1gKTtcbiAgICAgICAgLy9hZGQgYW4gZXZlbnQgd2l0aCBhIG5hbWUgYXMgbmV3IG9yIHRvIGV4aXN0aW5nIGxpc3RcbiAgICAgICAgdGhpcy5ldmVudHNbZXZOYW1lXSA9IHRoaXMuZXZlbnRzW2V2TmFtZV0gfHwgW107XG4gICAgICAgIHRoaXMuZXZlbnRzW2V2TmFtZV0ucHVzaChmbik7XG4gICAgfSxcbiAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKGV2TmFtZSwgZm4pIHtcbiAgICAgICAgY29uc29sZS5sb2coYFBVQlNVQjogc29tZW9uZSBqdXN0IFVOc3Vic2NyaWJlZCBmcm9tICR7ZXZOYW1lfWApO1xuICAgICAgICAvL3JlbW92ZSBhbiBldmVudCBmdW5jdGlvbiBieSBuYW1lXG4gICAgICAgIGlmICh0aGlzLmV2ZW50c1tldk5hbWVdKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50c1tldk5hbWVdID0gdGhpcy5ldmVudHNbZXZOYW1lXS5maWx0ZXIoZiA9PiBmICE9PSBmbik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHB1Ymxpc2g6IGZ1bmN0aW9uIChldk5hbWUsIGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coYFBVQlNVQjogTWFraW5nIGFuIGJyb2FkY2FzdCBhYm91dCAke2V2TmFtZX0gd2l0aCAke2RhdGF9YCk7XG4gICAgICAgIC8vZW1pdHxwdWJsaXNofGFubm91bmNlIHRoZSBldmVudCB0byBhbnlvbmUgd2hvIGlzIHN1YnNjcmliZWRcbiAgICAgICAgaWYgKHRoaXMuZXZlbnRzW2V2TmFtZV0pIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2TmFtZV0uZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICBmKGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59OyIsImltcG9ydCB7IGVsLCBpZCB9IGZyb20gXCJkYXRlLWZucy9sb2NhbGVcIjtcbmltcG9ydCB7IGxpYnMgfSBmcm9tIFwiLi9saWJzXCI7XG5pbXBvcnQgeyBwdWJzdWIgfSBmcm9tICcuL3B1YnN1Yi5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRhc2tzKCkge1xuXG5cbiAgICBjb25zdCBUYXNrID0gZnVuY3Rpb24gKHRhc2tPYmopIHtcblxuICAgICAgICBsZXQgX3Rhc2tOYW1lID0gdGFza09iai50YXNrTmFtZVxuICAgICAgICBsZXQgX3Rhc2tQcm9qZWN0ID0gdGFza09iai5wcm9qZWN0XG4gICAgICAgIGxldCBkYXRlQ3JlYXRlZCA9IG5ldyBEYXRlKCkuZ2V0RGF0ZSgpXG4gICAgICAgIGxldCBpZCA9IHRhc2tPYmouaWRcbiAgICAgICAgbGV0IHN0YXR1cyA9IGZhbHNlXG5cbiAgICAgICAgY29uc3QgY2hhbmdlU3RhdHVzID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYoc3RhdHVzKSB7IHN0YXR1cyA9IGZhbHNlfVxuICAgICAgICAgICAgZWxzZSB7IHN0YXR1cyA9IHRydWV9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0dXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2V0VGFza1Byb2plY3QgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gX3Rhc2tQcm9qZWN0XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBnZXROYW1lID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIF90YXNrTmFtZVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2V0SWQgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaWRcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBnZXROYW1lLCBnZXRUYXNrUHJvamVjdCAsICBnZXRJZCwgY2hhbmdlU3RhdHVzfVxuICAgIH1cblxuICAgIGNvbnN0IHRhc2tMb2dpYyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBfdGFza3MgPSBbXVxuXG4gICAgICAgIGNvbnN0IGFkZFRhc2sgPSAodGFzaykgPT4ge1xuICAgICAgICAgICAgX3Rhc2tzLnB1c2godGFzaylcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKF90YXNrcyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZW1vdmVUYXNrID0gKGlkKSA9PiB7XG5cbiAgICAgICAgICAgIGxldCByZW1vdmVpbmRleCA9IHVuZGVmaW5lZFxuICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgX3Rhc2tzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgaWYoX3Rhc2tzW2luZGV4XS5nZXRJZCgpID09IGlkICkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJlbW92ZWluZGV4ID0gaW5kZXhcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICBpZihyZW1vdmVpbmRleCAhPSB1bmRlZmluZWQgfHwgcmVtb3ZlaW5kZXggIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBfdGFza3Muc3BsaWNlKHJlbW92ZWluZGV4LCAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICBcbiAgICAgICAgICAgfVxuXG4gICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2hhbmdlU3RhdHVzYnlJRCA9IChpZCkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgdGFza0luZGV4ID0gdW5kZWZpbmVkXG4gICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfdGFza3MubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICBpZihfdGFza3NbaW5kZXhdLmdldElkKCkgPT0gaWQgKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFza0luZGV4ID0gaW5kZXhcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICBpZih0YXNrSW5kZXggIT0gdW5kZWZpbmVkIHx8IHRhc2tJbmRleCAhPSAtMSkge1xuICAgICAgICAgICAgICAgIF90YXNrc1t0YXNrSW5kZXhdLmNoYW5nZVN0YXR1cygpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgIFxuICAgICAgICAgICB9XG5cbiAgICAgXG4gICAgICAgIH1cblxuXG5cblxuXG4gICAgICAgIHJldHVybiB7IGFkZFRhc2ssIHJlbW92ZVRhc2ssIGNoYW5nZVN0YXR1c2J5SUR9XG4gICAgfSkoKVxuXG5cbiAgICBjb25zdCBsaWJzSGVscGVyID0gbGlicygpXG5cbiAgICBjb25zdCBkaXZCb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb25zdCBkaXZDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnN0IGRpdlJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBkaXZHYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgZGl2Qm9keUNsYXNzID0gJ2NvbC04IGNvbnRhaW5lci1zbSBiZy1saWdodCBjYXJkLWJvZHknXG4gICAgY29uc3QgZGl2Q29udGFpbmVyQ2xhc3MgPSAnY29udGFpbmVyLW1kIGNhcmQgbS0yIHAtMSBtci0xJ1xuICAgIGNvbnN0IGRpdlJvd0NsYXNzID0gJ2NvbnRhaW5lciByb3cnXG5cbiAgICBjb25zdCBkaXZHYXBDbGFzcyA9ICdjb2wtMSBiZy1saWdodCdcblxuXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGRpdkJvZHksIGRpdkJvZHlDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MoZGl2Q29udGFpbmVyLCBkaXZDb250YWluZXJDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MoZGl2Um93LCBkaXZSb3dDbGFzcylcblxuICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhkaXZHYXAsIGRpdkdhcENsYXNzKVxuXG4gICAgZGl2Um93LnN0eWxlID0gJ2dhcDogMTBweCdcblxuXG5cbiAgICBkaXZDb250YWluZXIuYXBwZW5kKGRpdlJvdylcbiAgICBkaXZCb2R5LmFwcGVuZChkaXZDb250YWluZXIpXG5cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVRhc2tNZW1vcnkodGFza09iaikge1xuICAgICAgICBsZXQgbmV3VGFzayA9IFRhc2sodGFza09iailcbiAgICAgICAgdGFza0xvZ2ljLmFkZFRhc2sobmV3VGFzaylcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVRhc2tEb20odGFza09iaikge1xuXG5cbiAgICAgICAgY29uc3QgdGFza0NvbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgICAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgICAgIGNvbnN0IHAyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgICAgIGNvbnN0IGJ0bkRvbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgICAgICBjb25zdCBidG5SZW1vdmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgICAgICBjb25zdCBociA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hyJylcblxuICAgICAgICBjb25zdCBwQ2xhc3MgPSAnbS0yIGNvbC14bCdcbiAgICAgICAgY29uc3QgcDJDbGFzcyA9ICdtLTIgY29sLWwnXG4gICAgICAgIGNvbnN0IGJ0bkRvbmVDbGFzcyA9ICdidG4gYnRuLW91dGxpbmUtcHJpbWFyeSBjb2wtc20gcGwtMidcbiAgICAgICAgY29uc3QgYnRuUmVtb3ZlQ2xhc3MgPSAnYnRuIGJ0bi1vdXRsaW5lLWRhbmdlciBjb2wtc20nXG4gICAgICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhwLCBwQ2xhc3MpXG4gICAgICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhwMixwMkNsYXNzKVxuICAgICAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MoYnRuRG9uZSwgYnRuRG9uZUNsYXNzKVxuICAgICAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MoYnRuUmVtb3ZlLCBidG5SZW1vdmVDbGFzcylcbiAgICAgICAgdGFza0NvbXAuYXBwZW5kKHAsIGJ0blJlbW92ZSwgYnRuRG9uZSlcbiAgICAgICAgYnRuRG9uZS5pbm5lclRleHQgPSAnRE9ORSdcbiAgICAgICAgYnRuUmVtb3ZlLmlubmVyVGV4dCA9ICdSZW1vdmUnXG4gICAgICAgIGNvbnNvbGUubG9nKHRhc2tPYmopO1xuICAgICAgICBwMi5pbm5lclRleHQgPSBgQmVsb25ncyB0byBQcm9qZWN0IGdyb3VwOiAke3Rhc2tPYmoucHJvamVjdH1gXG4gICAgICAgIHAuaW5uZXJUZXh0ID0gdGFza09iai50YXNrTmFtZVxuICAgICAgICBwLnN0eWxlID0gJ2ZsZXgtZ3JvdzogMTAnXG4gICAgICAgIHRhc2tDb21wLnNldEF0dHJpYnV0ZSgnaWQnLCB0YXNrT2JqLmlkKVxuICAgICAgICB0YXNrQ29tcC5hcHBlbmQocCxwMixidG5SZW1vdmUsIGJ0bkRvbmUsIGhyKVxuXG4gICAgICAgIGJ0bkRvbmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge3B1YnN1Yi5wdWJsaXNoKCdoYW5kbGVEb25lJywgZS50YXJnZXQucGFyZW50Tm9kZSkgfSlcbiAgICAgICAgYnRuUmVtb3ZlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4ge3B1YnN1Yi5wdWJsaXNoKCdoYW5kbGVSZW1vdmUnLCBlLnRhcmdldC5wYXJlbnROb2RlKSB9KVxuXG4gICAgICAgIHJldHVybiB0YXNrQ29tcFxuXG4gICAgfVxuXG4gICAgcHVic3ViLnN1YnNjcmliZSgnaGFuZGxlRG9uZScsIGNoYW5nZVN0YXR1cylcbiAgICBwdWJzdWIuc3Vic2NyaWJlKCdoYW5kbGVEb25lJywgY2hhbmdlU3RhdHVzRG9tKVxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ2hhbmRsZVJlbW92ZScsIHJlbW92ZUZyb21Eb20gKVxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ2hhbmRsZVJlbW92ZScsIHJlbW92ZUZyb21PYmogKVxuICAgIGZ1bmN0aW9uIHJlbW92ZUZyb21Eb20gKGVsKSB7XG4gICAgICAgIGVsLnJlbW92ZSgpXG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjaGFuZ2VTdGF0dXMoZWxlbWVudCkge1xuICAgICAgICBsZXQgaWQgPSBlbGVtZW50LmlkXG4gICAgICAgIHRhc2tMb2dpYy5jaGFuZ2VTdGF0dXNieUlEKGlkKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoYW5nZVN0YXR1c0RvbShlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGJ0biA9IGVsZW1lbnQuY2hpbGROb2Rlc1szXVxuICAgICAgIFxuICAgICAgICBpZihidG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdidG4tc3VjY2VzcycpKXtcbiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdidG4tc3VjY2VzcycpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnYnRuLXN1Y2Nlc3MnKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbiBcblxuICAgIGZ1bmN0aW9uIHJlbW92ZUZyb21PYmogKGVsKSB7XG4gICAgICAgIHRhc2tMb2dpYy5yZW1vdmVUYXNrKGVsLmlkKVxuICAgIH1cblxuXG5cbiAgICBmdW5jdGlvbiBhcHBlbmRUYXNrKHRhc2spIHtcbiAgICAgICAgZGl2Um93LmFwcGVuZCh0YXNrKVxuICAgIH1cblxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ25ld1Rhc2snLCAoZGF0YSkgPT4ge1xuXG4gICAgICAgIGNvbnN0IG5ld1Rhc2sgPSBjcmVhdGVUYXNrRG9tKGRhdGEpXG4gICAgICAgIGFwcGVuZFRhc2sobmV3VGFzaylcbiAgICB9KVxuXG4gICAgcHVic3ViLnN1YnNjcmliZSgnbmV3VGFzaycsIChkYXRhKSA9PiB7IGNyZWF0ZVRhc2tNZW1vcnkoZGF0YSkgfSlcbiAgICBwdWJzdWIuc3Vic2NyaWJlKCdyZW1vdmVUYXNrJywgKHRhc2spID0+IHRhc2tMb2dpYy5yZW1vdmVUYXNrKVxuXG5cblxuXG4gICAgcmV0dXJuIGRpdkJvZHlcbn0iLCJpbXBvcnQgeyBhZGQgfSBmcm9tIFwiZGF0ZS1mbnNcIjtcbmltcG9ydCBuYXZiYXIgZnJvbSBcIi4vbmF2YmFyXCJcbmltcG9ydCBzaWRlYmFyIGZyb20gXCIuL3NpZGViYXJcIlxuaW1wb3J0IHRhc2tzIGZyb20gXCIuL3Rhc2tzXCI7XG5cbmV4cG9ydCBkZWZhdWx0XG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9Ib29rIGZvciBmb3IgY29udGVudFxuXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZSkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250ZW50JylcbiAgICAgICAgICAgIGNvbnN0IF9uYXYgPSBuYXZiYXIoKVxuICAgICAgICAgICAgY29uc3QgX3NpZGViYXIgPSBzaWRlYmFyKCkuZGl2U2lkZWJhclxuICAgICAgICAgICAgY29uc3QgX3Rhc2tzID0gdGFza3MoKVxuXG4gICAgICAgICAgICBjb250ZW50LmFwcGVuZChfbmF2KVxuICAgICAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgncm93JylcbiAgICAgICAgICAgIGRpdi5hcHBlbmQoX3NpZGViYXIpXG4gICAgICAgICAgICBkaXYuYXBwZW5kKF90YXNrcylcbiAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kKGRpdilcbiAgICAgICAgfSlcblxuXG4gICAgfSkoKVxuXG4iLCJcblxuaW1wb3J0IHsgbGlicyB9IGZyb20gXCIuL2xpYnNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG5hdigpIHtcblxuICAgIC8vSU5JVCBMSUJTXG4gICAgY29uc3QgbGlic0hlbHBlciA9IGxpYnMoKVxuXG4gICAgLy9DUkVBVEUgRUxFTUVOVFNcbiAgICBjb25zdCBuYXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCduYXYnKVxuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cbiAgICAvL0NMQVNTIFNUUklORyBGUk9NIEhUTUwgQk9JTEVSIFBMQVRFXG4gICAgY29uc3QgbmF2Q2xhc3MgPSAnbmF2YmFyIG5hdmJhci1leHBhbmQtbWQgbmF2YmFyLWRhcmsgYmctZGFyaydcbiAgICBjb25zdCBkaXZDbGFzcyA9ICdjb250YWluZXItZmx1aWQnXG4gICAgY29uc3QgYUNsYXNzID0gJ25hdmJhci1icmFuZCdcblxuXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKG5hdiwgbmF2Q2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGRpdiwgZGl2Q2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGEsIGFDbGFzcylcblxuICAgIC8vQWRkIFRleHQgQ29udGVudFxuICAgIGEuaW5uZXJUZXh0ID0gJ1RvZG9saXN0J1xuXG4gICAgZGl2LmFwcGVuZChhKVxuICAgIG5hdi5hcHBlbmQoZGl2KVxuXG4gICAgcmV0dXJuIG5hdlxuXG59IiwiXG5cbmltcG9ydCB7IGl0LCB0YSB9IGZyb20gXCJkYXRlLWZucy9sb2NhbGVcIjtcbmltcG9ydCB7IGxpYnMgfSBmcm9tIFwiLi9saWJzXCI7XG5pbXBvcnQgeyBwdWJzdWIgfSBmcm9tICcuL3B1YnN1Yi5qcyc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzaWRlYmFyKCkge1xuXG4gICAgLy9JTklUIExJQlNcbiAgICBjb25zdCBsaWJzSGVscGVyID0gbGlicygpXG5cbiAgICAvL0NSRUFURSBFTEVNRU5UU1xuICAgIGNvbnN0IGRpdlNpZGViYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgY29uc3QgaHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdocicpO1xuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKVxuXG4gICAgY29uc3QgZm9ybVByb2plY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBjb25zdCBmb3JtRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IGZvcm1UYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gICAgY29uc3QgZm9ybVRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnN0IHRhc2tTdWJtaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGNvbnN0IHRhc2tJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBjb25zdCB0YXNrVGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcmVhJylcblxuXG5cbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIC8vRGl2ZGVyXG4gICAgY29uc3QgZGl2RGl2ZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBidG5Qcm9qZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgY29uc3QgYnRuVGFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG5cbiAgICAvL0NMQVNTIFNUUklORyBGUk9NIEhUTUwgQk9JTEVSIFBMQVRFXG4gICAgY29uc3QgZGl2U2lkZWJhckNsYXNzID0gJ2QtZmxleCBmbGV4LWNvbHVtbiBmbGV4LXNocmluay0wIHAtMyBiZy1saWdodCBjb2wtMyBib3JkZXInXG4gICAgY29uc3QgYUNsYXNzID0gXCJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIG1iLTMgbWItbWQtMCBtZS1tZC1hdXRvIGxpbmstZGFyayB0ZXh0LWRlY29yYXRpb24tbm9uZVwiXG4gICAgY29uc3QgaW1nQ2xhc3MgPSAnbS0yJ1xuICAgIGNvbnN0IHNwYW5DbGFzcyA9ICdmcy00J1xuICAgIC8vIGNvbnN0IGhyQ2xhc3MgPSAnJ1xuICAgIGNvbnN0IHVsQ2xhc3MgPSAnbmF2IG5hdi1waWxscyBmbGV4LWNvbHVtbiBtYi1hdXRvJ1xuICAgIGNvbnN0IGRpdkRpdmRlQ2xhc3MgPSAnYi1leGFtcGxlLWRpdmlkZXIgZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXInXG4gICAgY29uc3QgYnRuUHJvamVjdENsYXNzID0gJ2J0biBidG4tcHJpbWF5J1xuICAgIGNvbnN0IGJ0blRhc2tDbGFzcyA9ICdidG4gYnRuLXByaW1heSBtLTInXG4gICAgY29uc3QgZm9ybVByb2plY3RDbGFzcyA9ICdmb3JtLWdyb3VwIG0tMiBwLTEgaW5wdXQtZ3JvdXAgZC1ub25lJ1xuICAgIGNvbnN0IGlucHV0Q2xhc3MgPSAnZm9ybS1jb250cm9sJ1xuICAgIGNvbnN0IHN1Ym1pdEJ0bkNsYXNzID0gJ2J0biBidG4tb3V0bGluZS1wcmltYXJ5J1xuICAgIGNvbnN0IGZvcm1UYXNrQ2xhc3MgPSAnZm9ybS1ncm91cCBtLTIgcC0xIGlucHV0LWdyb3VwIGQtbm9uZSdcbiAgICBjb25zdCBmb3JtVGFza0RpdkNsYXNzID0gJ2QtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyJ1xuICAgIC8vQ0xBU1NJTkcgRUxFTUVOVFNcblxuICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhkaXZTaWRlYmFyLCBkaXZTaWRlYmFyQ2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGltZywgaW1nQ2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGEsIGFDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3Moc3Bhbiwgc3BhbkNsYXNzKVxuICAgIC8vIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhociwgaHJDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3ModWwsIHVsQ2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGRpdkRpdmRlLCBkaXZEaXZkZUNsYXNzKVxuICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhidG5Qcm9qZWN0LCBidG5Qcm9qZWN0Q2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGJ0blRhc2ssIGJ0blRhc2tDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MoZm9ybVByb2plY3QsIGZvcm1Qcm9qZWN0Q2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKGZvcm1UYXNrLCBmb3JtVGFza0NsYXNzKVxuICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhmb3JtVGFza0RpdiwgZm9ybVRhc2tEaXZDbGFzcylcblxuICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhpbnB1dCwgaW5wdXRDbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3Moc3VibWl0QnRuLCBzdWJtaXRCdG5DbGFzcylcbiAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3ModGFza1N1Ym1pdEJ0biwgc3VibWl0QnRuQ2xhc3MpXG4gICAgbGlic0hlbHBlci5zdHJpbmdUb0NsYXNzKHRhc2tJbnB1dCwgaW5wdXRDbGFzcylcblxuXG4gICAgLy9TRVRUSU5HUyBQUk9QU1xuICAgIGRpdlNpZGViYXIuc3R5bGUgPSAnd2lkdGg6IDI4MHB4OydcbiAgICBzcGFuLmlubmVyVGV4dCA9ICdQcm9qZWN0cydcbiAgICBpbWcuc3R5bGUgPSAnd2lkdGg6IDMwcHgnXG4gICAgYnRuUHJvamVjdC5pbm5lclRleHQgPSAnKyBOZXcgUHJvamVjdCdcbiAgICBidG5UYXNrLmlubmVyVGV4dCA9ICcrIFRhc2snXG4gICAgZm9ybURpdi5zdHlsZSA9ICd3aWR0aDogMTUwcHg7J1xuICAgIGZvcm1UYXNrRGl2LnN0eWxlID0gJ3dpZHRoOiAyMDBweCdcbiAgICBzdWJtaXRCdG4uaW5uZXJUZXh0ID0gJysnXG4gICAgdGFza1N1Ym1pdEJ0bi5pbm5lclRleHQgPSAnKydcblxuXG4gICAgLy9TRVRUSU5HIEFUVFNcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJywgJ05ldyBQcm9qZWN0JylcbiAgICB0YXNrSW5wdXQuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdOZXcgVGFzaycpXG4gICAgdWwuc2V0QXR0cmlidXRlKCdpZCcsICdwcm9qZWN0VWwnKVxuICAgIGltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuLi9zYW5kYm94L3B1YmxpYy90b2RvLnN2ZycpXG4gICAgZm9ybVByb2plY3Quc2V0QXR0cmlidXRlKCdhY3Rpb24nLCAnc3VibWl0JylcbiAgICBmb3JtUHJvamVjdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Zvcm1Qcm9qZWN0JylcbiAgICBmb3JtVGFzay5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICdzdWJtaXQnKVxuICAgIGZvcm1UYXNrLnNldEF0dHJpYnV0ZSgnaWQnLCAnZm9ybVRhc2snKVxuICAgIGZvcm1UYXNrLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0YXNrRm9ybScpXG4gICAgdGFza0lucHV0LnNldEF0dHJpYnV0ZSgnbmFtZScsICd0YXNrTmFtZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgJ25hbWUnKVxuXG5cbiAgICBjb25zdCBzaWRlYmFyTWVtb3J5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBbXVxuXG4gICAgICAgIGNvbnN0IGFkZFByb2plY3QgPSAocCkgPT4ge1xuICAgICAgICAgICAgcHJvamVjdHMucHVzaChwKVxuICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2V0TGVuZ3RoID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHByb2plY3RzLmxlbmd0aFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgYWRkUHJvamVjdCwgZ2V0TGVuZ3RoIH1cblxuICAgIH1cblxuICAgICkoKVxuXG4gICAgY29uc3QgUHJvamVjdCA9IGZ1bmN0aW9uIChwcm9qZWN0TmFtZSkge1xuICAgICAgICBsZXQgbmFtZSA9IHByb2plY3ROYW1lLm5hbWVcbiAgICAgICAgbGV0IGRhdGVDcmVhdGVkID0gbmV3IERhdGUoKS5nZXREYXRlKClcblxuICAgICAgICByZXR1cm4geyBuYW1lLCBkYXRlQ3JlYXRlZCB9XG4gICAgfVxuXG5cbiAgICAvL0VWRU5UIExJU1RORVJTXG5cbiAgICBmb3JtUHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgbGV0IGRhdGEgPSBsaWJzSGVscGVyLmdldEZvcm1EYXRhKGUpXG4gICAgICAgIHB1YnN1Yi5wdWJsaXNoKCdsaVN1Ym1pdCcsIGRhdGEubmFtZSlcbiAgICAgICAgcHVic3ViLnB1Ymxpc2goJ25ld1Byb2plY3QnLCBkYXRhKVxuICAgICAgICBmb3JtUHJvamVjdC5yZXNldCgpXG4gICAgfSlcblxuXG5cbiAgICBmdW5jdGlvbiBoYW5kbGVOZXdQcm9qZWN0KGRhdGEpIHtcbiAgICAgICAgbGV0IG5ld1AgPSBQcm9qZWN0KGRhdGEpXG4gICAgICAgIHNpZGViYXJNZW1vcnkuYWRkUHJvamVjdChuZXdQKVxuICAgIH1cblxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ25ld1Byb2plY3QnLCBoYW5kbGVOZXdQcm9qZWN0KVxuXG4gICAgZm9ybVRhc2suYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGxldCBkYXRhID0gbGlic0hlbHBlci5nZXRGb3JtRGF0YShlKVxuICAgICAgICBsZXQgc2VsZWN0ZWQgPSBkb2N1bWVudC5nZXRcblxuXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbc2VsZWN0ZWQ9XCJ0cnVlXCJdJyk7XG4gICAgICAgIGlmKHByb2plY3QubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGFsZXJ0KCdOZWVkIHRvIFNlbGVjdCBQcm9qZWN0JylcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3ZWVlZSB3ZXd3ZScpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0KTtcbiAgICAgICAgICAgIGRhdGEucHJvamVjdCA9IHByb2plY3RbMF0uaW5uZXJUZXh0XG4gICAgICAgICAgICBkYXRhLmlkID0gbGlic0hlbHBlci5nZXRJRCgpXG4gICAgICAgICAgICBjb25zb2xlLmxvZygoZGF0YSkpO1xuXG4gICAgXG4gICAgICAgICAgICBpZiAoc2lkZWJhck1lbW9yeS5nZXRMZW5ndGgoKSA+PSAxKSB7XG4gICAgICAgICAgICAgICAgcHVic3ViLnB1Ymxpc2goJ25ld1Rhc2snLCBkYXRhKVxuICAgICAgICAgICAgICAgIGZvcm1UYXNrLnJlc2V0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0KCdORUVEIEFUTEVBU1QgT05FIFBST0pFQ1QnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9KVxuXG5cblxuICAgIGJ0blByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBwdWJzdWIucHVibGlzaCgndG9vZ2xlRm9ybScsICdmb3JtUHJvamVjdCcpXG4gICAgfSlcblxuICAgIGJ0blRhc2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBwdWJzdWIucHVibGlzaCgndG9vZ2xlVGFzaycsICdmb3JtVGFzaycpXG4gICAgfSlcblxuXG5cbiAgICBwdWJzdWIuc3Vic2NyaWJlKCd0b29nbGVGb3JtJywgbGlic0hlbHBlci50b29nbGVFbGVtZW50KVxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ3Rvb2dsZVRhc2snLCBsaWJzSGVscGVyLnRvb2dsZUVsZW1lbnQpXG5cbiAgICBwdWJzdWIuc3Vic2NyaWJlKCdsaVN1Ym1pdCcsIGNyZWF0ZUxpKVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlTGkodGV4dCkge1xuXG4gICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcblxuXG5cbiAgICAgICAgY29uc3QgbGlDbGFzcyA9ICduYXYtaXRlbSBtLTInXG4gICAgICAgIGNvbnN0IGFDTGFzcyA9ICduYXYtbGluayBhY3RpdmUnXG5cblxuICAgICAgICAvLyBjbGFzc2VzIFxuICAgICAgICBsaWJzSGVscGVyLnN0cmluZ1RvQ2xhc3MobGksIGxpQ2xhc3MpXG4gICAgICAgIGxpYnNIZWxwZXIuc3RyaW5nVG9DbGFzcyhhLCBhQ0xhc3MpXG5cblxuXG4gICAgICAgIC8vYSBsaW5rIFByb3BzXG4gICAgICAgIGEuaW5uZXJUZXh0ID0gdGV4dFxuXG5cblxuICAgICAgICBsaS5hcHBlbmQoYSlcblxuICAgICAgICBwdWJzdWIucHVibGlzaCgnY3JlYXRlTGknLCBsaSlcbiAgICAgICAgbGkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyBwdWJzdWIucHVibGlzaCgncHJvamVjdENsaWNrZWQnLCBlLnRhcmdldCkgfSlcbiAgICAgICAgcmV0dXJuIGxpXG4gICAgfVxuXG5cbiAgICBwdWJzdWIuc3Vic2NyaWJlKCdwcm9qZWN0Q2xpY2tlZCcsIGNoYW5nZUJ0bkNvbG9yKVxuXG4gICAgcHVic3ViLnN1YnNjcmliZSgncHJvamVjdENsaWNrZWQnLCBzZXRTZWxlY3RlZExpKVxuXG5cbiAgICBmdW5jdGlvbiBzZXRTZWxlY3RlZExpKHRhcmdldCkge1xuICAgICAgICBsZXQgbGlMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3RVbCcpLmNoaWxkTm9kZXNcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGxpTGlzdC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIGxpTGlzdFtpbmRleF0ucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcpXG4gICAgICAgICAgICBsaUxpc3RbaW5kZXhdLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZCA9PiB7IGNoaWxkLnJlbW92ZUF0dHJpYnV0ZSgnc2VsZWN0ZWQnKSB9KVxuICAgICAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnc2VsZWN0ZWQnLCAndHJ1ZScpXG4gICAgICAgIH1cbiAgICB9XG5cblxuXG4gICAgZnVuY3Rpb24gY2hhbmdlQnRuQ29sb3IodGFyZ2V0KSB7XG4gICAgICAgIGxldCBsaUxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdFVsJykuY2hpbGROb2Rlc1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbGlMaXN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgbGlMaXN0W2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKCdiZy1zdWNjZXNzJylcbiAgICAgICAgICAgIGxpTGlzdFtpbmRleF0uY2hpbGROb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHsgY2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYmctc3VjY2VzcycpIH0pXG5cbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnYmctc3VjY2VzcycpXG4gICAgfVxuXG5cblxuICAgIHB1YnN1Yi5zdWJzY3JpYmUoJ2NyZWF0ZUxpJywgYmluZExpKVxuICAgIGZ1bmN0aW9uIGJpbmRMaShsaSkge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpLmFwcGVuZChsaSlcbiAgICB9XG5cblxuICAgIGEuYXBwZW5kKGltZywgc3BhbilcblxuICAgIGZvcm1EaXYuYXBwZW5kKGlucHV0KVxuICAgIGZvcm1Qcm9qZWN0LmFwcGVuZChzdWJtaXRCdG4pXG4gICAgZm9ybVByb2plY3QuYXBwZW5kKGZvcm1EaXYpXG5cblxuICAgIGZvcm1UYXNrLmFwcGVuZCh0YXNrU3VibWl0QnRuLCB0YXNrSW5wdXQpXG4gICAgZm9ybVRhc2tEaXYuYXBwZW5kKGZvcm1UYXNrKVxuXG4gICAgZGl2U2lkZWJhci5hcHBlbmQoYSlcbiAgICBkaXZTaWRlYmFyLmFwcGVuZChidG5Qcm9qZWN0KVxuICAgIGRpdlNpZGViYXIuYXBwZW5kKGJ0blRhc2spXG4gICAgZGl2U2lkZWJhci5hcHBlbmQoZm9ybVByb2plY3QpXG4gICAgZGl2U2lkZWJhci5hcHBlbmQoZm9ybVRhc2tEaXYpXG4gICAgZGl2U2lkZWJhci5hcHBlbmQoaHIpXG4gICAgZGl2U2lkZWJhci5hcHBlbmQodWwpXG4gICAgZGl2U2lkZWJhci5hcHBlbmQoZGl2RGl2ZGUpXG5cblxuXG4gICAgcmV0dXJuIHsgZGl2U2lkZWJhciB9XG5cbn1cblxuLy8gTWFrZSBhIFNtYWxsIGZvcm0gdW5kZSB0aGUgcHJvamVjdCBHYW1lcGFkQnV0dG9uLCB3aGVuIG5ldyBQcm9qZWN0IGlzIHByZXNzZWQgXG4vLyBpdCBzaG93cyB0aGUgbGl0dGxlIGZvcm0gYnkgc2hvd2luZyBpdCdzIHZpc2FibGl0eSBhbmQgd2hlbiB5b3UgcHJlc3Mgc3VtYml0IGl0IGNhbGxzIHB1cHN1YlxuLy90aGUgY2FsbHMgYWRkIExJIGZ1bmN0aW9uIl0sIm5hbWVzIjpbImxpYnMiLCJzcGxpdFN0cmluZyIsInN0cmluZyIsInNwbGl0IiwiY2xhc3NBZGRlciIsImVsZW1lbnQiLCJhcnJheSIsImZvckVhY2giLCJjbGFzc0xpc3QiLCJhZGQiLCJnZXRJRCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInN0cmluZ1RvQ2xhc3MiLCJnZXRGb3JtRGF0YSIsImV2ZW50IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInRhcmdldCIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiZm9ybVByb3BzIiwidG9vZ2xlRWxlbWVudCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRhaW5zIiwicmVtb3ZlIiwicHVic3ViIiwiZXZlbnRzIiwic3Vic2NyaWJlIiwiZXZOYW1lIiwiZm4iLCJjb25zb2xlIiwibG9nIiwidGhpcyIsInB1c2giLCJ1bnN1YnNjcmliZSIsImZpbHRlciIsImYiLCJwdWJsaXNoIiwiZGF0YSIsInRhc2tzIiwidGFza0xvZ2ljIiwiX3Rhc2tzIiwiYWRkVGFzayIsInRhc2siLCJyZW1vdmVUYXNrIiwicmVtb3ZlaW5kZXgiLCJpbmRleCIsImxlbmd0aCIsImdldElkIiwidW5kZWZpbmVkIiwic3BsaWNlIiwiY2hhbmdlU3RhdHVzYnlJRCIsInRhc2tJbmRleCIsImNoYW5nZVN0YXR1cyIsImxpYnNIZWxwZXIiLCJkaXZCb2R5IiwiY3JlYXRlRWxlbWVudCIsImRpdkNvbnRhaW5lciIsImRpdlJvdyIsImRpdkdhcCIsInN0eWxlIiwiYXBwZW5kIiwiYnRuIiwiY2hpbGROb2RlcyIsImVsIiwidGFza09iaiIsInRhc2tDb21wIiwicCIsInAyIiwiYnRuRG9uZSIsImJ0blJlbW92ZSIsImhyIiwiaW5uZXJUZXh0IiwicHJvamVjdCIsInRhc2tOYW1lIiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwYXJlbnROb2RlIiwiY3JlYXRlVGFza0RvbSIsIm5ld1Rhc2siLCJfdGFza05hbWUiLCJfdGFza1Byb2plY3QiLCJEYXRlIiwiZ2V0RGF0ZSIsInN0YXR1cyIsImdldE5hbWUiLCJnZXRUYXNrUHJvamVjdCIsIlRhc2siLCJjcmVhdGVUYXNrTWVtb3J5IiwiY29udGVudCIsIl9uYXYiLCJuYXYiLCJkaXYiLCJhIiwiX3NpZGViYXIiLCJkaXZTaWRlYmFyIiwiaW1nIiwic3BhbiIsInVsIiwiZm9ybVByb2plY3QiLCJmb3JtRGl2IiwiZm9ybVRhc2siLCJmb3JtVGFza0RpdiIsInRhc2tTdWJtaXRCdG4iLCJ0YXNrSW5wdXQiLCJpbnB1dCIsInN1Ym1pdEJ0biIsImRpdkRpdmRlIiwiYnRuUHJvamVjdCIsImJ0blRhc2siLCJpbnB1dENsYXNzIiwic3VibWl0QnRuQ2xhc3MiLCJzaWRlYmFyTWVtb3J5IiwicHJvamVjdHMiLCJhZGRQcm9qZWN0IiwiZ2V0TGVuZ3RoIiwicHJldmVudERlZmF1bHQiLCJuYW1lIiwicmVzZXQiLCJuZXdQIiwiZGF0ZUNyZWF0ZWQiLCJnZXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYWxlcnQiLCJ0ZXh0IiwibGkiLCJsaUxpc3QiLCJjaGlsZCIsInJlbW92ZUF0dHJpYnV0ZSIsInF1ZXJ5U2VsZWN0b3IiLCJzaWRlYmFyIl0sInNvdXJjZVJvb3QiOiIifQ==